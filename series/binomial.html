<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Binomial Expansion (Pure 1)</title>
    
    <!-- 1. CONFIGURE MATHJAX -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            svg: { fontCache: 'global' }
        };
    </script>

    <!-- 2. LOAD MATHJAX -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --primary: #0984e3; /* Blue theme for P1 */
            --secondary: #74b9ff;
            --success: #00b894;
            --error: #d63031;
            --bg: #dfe6e9;
            --card: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .main-card {
            background: var(--card);
            width: 100%;
            max-width: 850px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        /* Header & Progress */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
        }

        .progress-container {
            width: 100%;
            height: 8px;
            background: #eee;
            border-radius: 4px;
            margin-top: 10px;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--primary);
            width: 0%;
            border-radius: 4px;
            transition: width 0.4s ease;
        }

        /* Slide Logic */
        .slide { display: none; animation: fadeUp 0.5s ease forwards; }
        .slide.active { display: block; }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 { color: var(--primary); margin: 0; font-size: 1.8rem; }
        h2 { color: var(--primary); margin-top: 0; opacity: 0.8; }
        p { line-height: 1.6; color: #444; font-size: 1.05rem; }

        /* Interactive Input Elements */
        .math-input {
            width: 70px;
            padding: 8px;
            border: 2px solid #b2bec3;
            border-radius: 8px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: bold;
            color: #2d3436;
            transition: 0.3s;
            background: #f1f2f6;
        }
        
        .math-input:focus { outline: none; border-color: var(--primary); background: #fff; }
        .math-input.correct { border-color: var(--success); background-color: #55efc4; color: #fff; }
        .math-input.wrong { border-color: var(--error); background-color: #fab1a0; color: #fff; }

        .pascal-row {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
        }

        .step-box {
            background: #f0f4f8;
            border-left: 5px solid var(--secondary);
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 10px 10px 0;
            display: none;
            opacity: 0;
            transform: translateX(-10px);
            transition: all 0.5s ease;
        }

        .step-box.visible { display: block; opacity: 1; transform: translateX(0); }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.1s, background 0.2s;
            margin: 5px;
        }
        .btn:hover { background: #74b9ff; }
        .btn:active { transform: scale(0.98); }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .highlight { font-weight: bold; color: var(--primary); }

    </style>
</head>
<body>

<div class="main-card">
    <div class="header">
        <h1>Binomial Expansion (Integer Powers)</h1>
        <span id="slide-indicator">1 / 4</span>
    </div>
    <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
    </div>

    <!-- SLIDE 1: Pascal's Triangle -->
    <div class="slide active" id="slide1">
        <h2>1. Pascal's Triangle</h2>
        <p>For small powers like $(a+b)^3$ or $(a+b)^4$, the coefficients follow a simple pattern.</p>
        <p><strong>Interactive Challenge:</strong> Complete the 4th row of Pascal's Triangle.</p>
        
        <div style="text-align: center; font-weight: bold; font-size: 1.2rem;">
            <div class="pascal-row">1</div>
            <div class="pascal-row">1 &nbsp;&nbsp; 1</div>
            <div class="pascal-row">1 &nbsp;&nbsp; 2 &nbsp;&nbsp; 1</div>
            <div class="pascal-row">1 &nbsp;&nbsp; 3 &nbsp;&nbsp; 3 &nbsp;&nbsp; 1</div>
            
            <!-- Interactive Row -->
            <div class="pascal-row" id="pascal-input-row">
                <span>1</span>
                <input type="number" class="math-input" placeholder="?" onkeyup="validateNum(this, 4, null)">
                <input type="number" class="math-input" placeholder="?" onkeyup="validateNum(this, 6, null)">
                <input type="number" class="math-input" placeholder="?" onkeyup="validateNum(this, 4, 's1-feedback')">
                <span>1</span>
            </div>
        </div>

        <div class="step-box" id="s1-feedback">
            <p><strong>Correct!</strong> The row is 1, 4, 6, 4, 1. These are the coefficients for $(a+b)^4$.</p>
        </div>
    </div>

    <!-- SLIDE 2: The nCr Formula -->
    <div class="slide" id="slide2">
        <h2>2. The $\binom{n}{r}$ Formula</h2>
        <p>For high powers (e.g., power 12), drawing the triangle is too slow. We use the formula:</p>
        $$ \binom{n}{r} = \frac{n!}{r!(n-r)!} $$
        <p>Where $n$ is the power, and $r$ is the term number (starting from 0).</p>

        <div class="step-box visible">
            <strong>Practice:</strong> Calculate $\binom{5}{2}$ (The coefficient of the $x^3y^2$ term).
            <p>Formula: $\frac{5!}{2!3!} = \frac{120}{2 \times 6}$</p>
            <p>Answer: <input type="number" class="math-input" onkeyup="validateNum(this, 10, 's2-final')"></p>
        </div>

        <div class="step-box" id="s2-final">
            <p>Exactly. $\binom{5}{2} = 10$. Your calculator button usually says <code>nCr</code>.</p>
        </div>
    </div>

    <!-- SLIDE 3: Full Expansion Interactive -->
    <div class="slide" id="slide3">
        <h2>3. Expanding $(a+b)^n$</h2>
        <p>Let's expand: $$ (x + 2)^3 $$</p>
        <p>Remember: Powers of $x$ go <strong>down</strong> (3, 2, 1, 0). Powers of 2 go <strong>up</strong> (0, 1, 2, 3).</p>
        
        <div class="step-box visible" style="font-size: 1.1rem;">
            $$ 1(x)^3 + \mathbf{A}(x)^2(2) + \mathbf{B}(x)(2)^2 + 1(2)^3 $$
            <br>
            <p>Step 1: What are coefficients $\mathbf{A}$ and $\mathbf{B}$ from Pascal's triangle (row 3)?</p>
            $A =$ <input type="number" class="math-input" style="width:50px" onkeyup="validateNum(this, 3, 's3-step2')">
            $B =$ <input type="number" class="math-input" style="width:50px" onkeyup="validateNum(this, 3, 's3-step2')">
        </div>

        <div class="step-box" id="s3-step2">
            <p>Step 2: Simplify the numbers.</p>
            <p>Term 2: $3 \times x^2 \times 2 = $ <input type="number" class="math-input" onkeyup="validateNum(this, 6, null)"> $x^2$</p>
            <p>Term 3: $3 \times x \times 2^2 = 3 \times 4x = $ <input type="number" class="math-input" onkeyup="validateNum(this, 12, 's3-final')"> $x$</p>
        </div>

        <div class="step-box" id="s3-final" style="background-color: #d1e7dd; border-color: #00b894;">
            <h3>ðŸŽ‰ Final Answer</h3>
            $$ x^3 + 6x^2 + 12x + 8 $$
        </div>
    </div>

    <!-- SLIDE 4: Finding Specific Coefficients -->
    <div class="slide" id="slide4">
        <h2>4. Exam Style: Specific Terms</h2>
        <p>Find the coefficient of $x^2$ in the expansion of $(2x - 3)^4$.</p>
        <p>General Term: $\binom{4}{r} (2x)^{4-r} (-3)^r$</p>
        
        <div style="text-align: center; margin: 20px;">
            <button class="btn" id="anim-btn" onclick="nextAnimStep()">Start Solution</button>
        </div>

        <div id="anim-container">
            <!-- Step 1 -->
            <div class="step-box" id="anim-1">
                <strong>Step 1: Find $r$</strong>
                We need $x^2$. The $x$ part is $(2x)^{4-r}$.
                So we need power $4-r = 2$.
                Therefore, $\mathbf{r = 2}$.
            </div>
            
            <!-- Step 2 -->
            <div class="step-box" id="anim-2">
                <strong>Step 2: Setup the calculation</strong>
                $$ \binom{4}{2} \times (2)^{2} \times (-3)^2 $$
                Note: We separated the coefficients from the $x$.
            </div>

            <!-- Step 3 -->
            <div class="step-box" id="anim-3">
                <strong>Step 3: Calculate parts</strong>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-top: 10px;">
                    <div>
                        $\binom{4}{2}$<br>
                        <input type="number" class="math-input" onkeyup="validateNum(this, 6, 'check-anim')">
                    </div>
                    <div>
                        $2^2$<br>
                        <input type="number" class="math-input" onkeyup="validateNum(this, 4, 'check-anim')">
                    </div>
                    <div>
                        $(-3)^2$<br>
                        <input type="number" class="math-input" onkeyup="validateNum(this, 9, 'check-anim')">
                    </div>
                </div>
            </div>

            <!-- Step 4 -->
            <div class="step-box" id="anim-4">
                <strong>Step 4: Multiply them all</strong>
                $$ 6 \times 4 \times 9 = 216 $$
                The coefficient is <strong>216</strong>.
            </div>
        </div>
    </div>

    <div class="navigation">
        <button class="btn" id="prevBtn" onclick="changeSlide(-1)" disabled>Previous</button>
        <button class="btn" id="nextBtn" onclick="changeSlide(1)">Next</button>
    </div>

</div>

<script>
    /* STATE MANAGEMENT */
    let currentSlide = 0;
    const totalSlides = 4;
    
    function updateUI() {
        // Update Slides
        document.querySelectorAll('.slide').forEach((s, i) => {
            s.classList.remove('active');
            if(i === currentSlide) s.classList.add('active');
        });

        // Update Progress
        document.getElementById('progress-bar').style.width = ((currentSlide + 1) / totalSlides * 100) + "%";
        document.getElementById('slide-indicator').innerText = `${currentSlide + 1} / ${totalSlides}`;

        // Update Buttons
        document.getElementById('prevBtn').disabled = currentSlide === 0;
        document.getElementById('nextBtn').innerText = currentSlide === totalSlides - 1 ? "Finish" : "Next";
    }

    function changeSlide(dir) {
        currentSlide += dir;
        if(currentSlide < 0) currentSlide = 0;
        if(currentSlide >= totalSlides) currentSlide = totalSlides - 1;
        updateUI();
    }

    /* VALIDATION LOGIC */
    function validateNum(input, expected, nextId) {
        // Allow for slight variations if needed, but for integers strict is fine
        if (parseInt(input.value) === expected) {
            input.classList.add('correct');
            input.classList.remove('wrong');
            
            // Special check for Slide 1 (Pascal) - requires all 3 inputs to be correct
            if(currentSlide === 0) {
                const inputs = document.querySelectorAll('#pascal-input-row .math-input');
                const allCorrect = Array.from(inputs).every(i => i.classList.contains('correct'));
                if(allCorrect && nextId) {
                     document.getElementById(nextId).classList.add('visible');
                }
            }
            // Special check for Slide 3 (Parts)
            else if(nextId === 'check-anim') {
                const animInputs = document.querySelectorAll('#anim-3 .math-input');
                const allCorrect = Array.from(animInputs).every(i => i.classList.contains('correct'));
                if(allCorrect) {
                    document.getElementById('anim-4').classList.add('visible');
                    MathJax.typesetPromise();
                }
            }
            // Standard check
            else if (nextId) {
                document.getElementById(nextId).classList.add('visible');
                MathJax.typesetPromise();
            }
        } else {
            input.classList.add('wrong');
        }
    }

    /* LOGIC: Slide 4 Animation */
    let animStep = 0;
    function nextAnimStep() {
        animStep++;
        const el = document.getElementById(`anim-${animStep}`);
        if(el) {
            el.classList.add('visible');
            MathJax.typesetPromise();
        }
        if(animStep === 3) document.getElementById('anim-btn').style.display = "none";
    }

    // Init
    updateUI();

</script>
</body>
</html>
