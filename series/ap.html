<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Arithmetic Progression</title>
    
    <!-- 1. CONFIGURE MATHJAX -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            svg: { fontCache: 'global' }
        };
    </script>

    <!-- 2. LOAD MATHJAX -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --primary: #00838f; /* Teal theme */
            --secondary: #4dd0e1;
            --success: #00b894;
            --error: #d63031;
            --bg: #e0f2f1;
            --card: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .main-card {
            background: var(--card);
            width: 100%;
            max-width: 850px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        /* Header & Progress */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
        }

        .progress-container {
            width: 100%;
            height: 8px;
            background: #eee;
            border-radius: 4px;
            margin-top: 10px;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--primary);
            width: 0%;
            border-radius: 4px;
            transition: width 0.4s ease;
        }

        /* Slide Logic */
        .slide { display: none; animation: fadeUp 0.5s ease forwards; }
        .slide.active { display: block; }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 { color: var(--primary); margin: 0; font-size: 1.8rem; }
        h2 { color: var(--primary); margin-top: 0; opacity: 0.8; }
        p { line-height: 1.6; color: #444; font-size: 1.05rem; }

        /* Interactive Input Elements */
        .math-input {
            width: 80px;
            padding: 8px;
            border: 2px solid #b2bec3;
            border-radius: 8px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: bold;
            color: #2d3436;
            transition: 0.3s;
            background: #f8f9fa;
        }
        
        .math-input:focus { outline: none; border-color: var(--primary); background: #fff; }
        .math-input.correct { border-color: var(--success); background-color: #55efc4; color: #fff; }
        .math-input.wrong { border-color: var(--error); background-color: #fab1a0; color: #fff; }

        .step-box {
            background: #f0f4f8;
            border-left: 5px solid var(--secondary);
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 10px 10px 0;
            display: none;
            opacity: 0;
            transform: translateX(-10px);
            transition: all 0.5s ease;
        }

        .step-box.visible { display: block; opacity: 1; transform: translateX(0); }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.1s, background 0.2s;
            margin: 5px;
        }
        .btn:hover { background: var(--secondary); }
        .btn:active { transform: scale(0.98); }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .sequence-display {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            text-align: center;
            letter-spacing: 2px;
            margin: 20px 0;
        }

    </style>
</head>
<body>

<div class="main-card">
    <div class="header">
        <h1>Arithmetic Progression (AP)</h1>
        <span id="slide-indicator">1 / 4</span>
    </div>
    <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
    </div>

    <!-- SLIDE 1: Identifying a and d -->
    <div class="slide active" id="slide1">
        <h2>1. Identifying the Sequence</h2>
        <p>An Arithmetic Progression adds (or subtracts) the same number every time.</p>
        
        <div class="sequence-display">3, 7, 11, 15, ...</div>

        <div class="step-box visible">
            <p><strong>Find the parameters:</strong></p>
            <p>First Term ($a$): <input type="number" class="math-input" onkeyup="validateNum(this, 3, null)"></p>
            <p>Common Difference ($d$): <input type="number" class="math-input" onkeyup="validateNum(this, 4, 's1-part2')"></p>
        </div>

        <div class="step-box" id="s1-part2">
            <p><strong>Try a Trickier One:</strong></p>
            <div class="sequence-display" style="font-size: 1.2rem;">10, 8, 6, 4, ...</div>
            <p>$d = $ <input type="number" class="math-input" placeholder="-?" onkeyup="validateNum(this, -2, 's1-final')"></p>
            <small>Remember: $d = \text{Second Term} - \text{First Term}$</small>
        </div>
        
        <div class="step-box" id="s1-final">
            <p><span style="color:var(--success)">Correct!</span> $d$ can be negative.</p>
        </div>
    </div>

    <!-- SLIDE 2: The nth Term Formula -->
    <div class="slide" id="slide2">
        <h2>2. Finding the $n$-th Term</h2>
        <p>Formula: $$ u_n = a + (n-1)d $$</p>
        <p>Let's find the <strong>20th term</strong> of the sequence: $3, 7, 11, \dots$</p>
        <p>Here $a=3$, $d=4$, and $n=20$.</p>

        <div class="step-box visible">
            <strong>Step 1: Set up the formula</strong>
            $$ u_{20} = 3 + (\dots) \times 4 $$
            What is $(n-1)$? 
            <input type="number" class="math-input" onkeyup="validateNum(this, 19, 's2-step2')">
        </div>

        <div class="step-box" id="s2-step2">
            <strong>Step 2: Calculate</strong>
            $$ u_{20} = 3 + (19 \times 4) $$
            $$ u_{20} = 3 + 76 $$
            $$ u_{20} = \dots $$
            <input type="number" class="math-input" onkeyup="validateNum(this, 79, 's2-final')">
        </div>

        <div class="step-box" id="s2-final" style="background-color: #d1e7dd; border-color: #00b894;">
            <p>Correct. The 20th term is 79.</p>
        </div>
    </div>

    <!-- SLIDE 3: Sum of n Terms -->
    <div class="slide" id="slide3">
        <h2>3. The Sum Formula ($S_n$)</h2>
        <p>Formula: $$ S_n = \frac{n}{2} [ 2a + (n-1)d ] $$</p>
        <p>Task: Find the sum of the first <strong>10 terms</strong> of $5, 8, 11, \dots$</p>
        <p>($a=5, d=3, n=10$)</p>

        <div class="step-box visible" id="s3-step1">
            <strong>Part A: Fill in the components</strong>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                <div>
                    $\frac{n}{2} = \frac{10}{2}$<br>
                    <input type="number" class="math-input" onkeyup="validateNum(this, 5, 'check-sum-parts')">
                </div>
                <div>
                    $2a = 2(5)$<br>
                    <input type="number" class="math-input" onkeyup="validateNum(this, 10, 'check-sum-parts')">
                </div>
                <div>
                    $(n-1)d = 9 \times 3$<br>
                    <input type="number" class="math-input" onkeyup="validateNum(this, 27, 'check-sum-parts')">
                </div>
            </div>
        </div>

        <div class="step-box" id="s3-final">
            <strong>Part B: Final Calculation</strong>
            $$ S_{10} = 5 \times [ 10 + 27 ] $$
            $$ S_{10} = 5 \times 37 $$
            Total Sum: <input type="number" class="math-input" onkeyup="validateNum(this, 185, 's3-done')">
        </div>
        
        <div class="step-box" id="s3-done" style="color: var(--success); font-weight:bold;">
            Perfect!
        </div>
    </div>

    <!-- SLIDE 4: Simultaneous Equations Animation -->
    <div class="slide" id="slide4">
        <h2>4. Exam Style: Unknown $a$ and $d$</h2>
        <p><strong>Problem:</strong> The 3rd term is 10. The 7th term is 22. Find $a$ and $d$.</p>
        
        <div style="text-align: center; margin: 20px;">
            <button class="btn" id="anim-btn" onclick="nextAnimStep()">Show Solution Steps</button>
        </div>

        <div id="anim-container">
            <!-- Step 1 -->
            <div class="step-box" id="anim-1">
                <strong>Step 1: Write equations</strong>
                <br>Term 3 ($n=3$): $a + 2d = 10$  --- (Eq 1)
                <br>Term 7 ($n=7$): $a + 6d = 22$  --- (Eq 2)
            </div>

            <!-- Step 2 -->
            <div class="step-box" id="anim-2">
                <strong>Step 2: Elimination (Eq 2 - Eq 1)</strong>
                $$ (a - a) + (6d - 2d) = (22 - 10) $$
                $$ 4d = 12 $$
            </div>

            <!-- Step 3 -->
            <div class="step-box" id="anim-3">
                <strong>Step 3: Solve for d</strong>
                $$ d = \frac{12}{4} = \mathbf{3} $$
            </div>

            <!-- Step 4 -->
            <div class="step-box" id="anim-4">
                <strong>Step 4: Substitute back to find a</strong>
                Using Eq 1: $a + 2(3) = 10$
                <br>$a + 6 = 10$
                <br>$\mathbf{a = 4}$
                <br><br>
                <span style="color: var(--primary)">Sequence: 4, 7, 10, 13...</span>
            </div>
        </div>
    </div>

    <div class="navigation">
        <button class="btn" id="prevBtn" onclick="changeSlide(-1)" disabled>Previous</button>
        <button class="btn" id="nextBtn" onclick="changeSlide(1)">Next</button>
    </div>

</div>

<script>
    /* STATE MANAGEMENT */
    let currentSlide = 0;
    const totalSlides = 4;
    
    function updateUI() {
        // Update Slides
        document.querySelectorAll('.slide').forEach((s, i) => {
            s.classList.remove('active');
            if(i === currentSlide) s.classList.add('active');
        });

        // Update Progress
        document.getElementById('progress-bar').style.width = ((currentSlide + 1) / totalSlides * 100) + "%";
        document.getElementById('slide-indicator').innerText = `${currentSlide + 1} / ${totalSlides}`;

        // Update Buttons
        document.getElementById('prevBtn').disabled = currentSlide === 0;
        document.getElementById('nextBtn').innerText = currentSlide === totalSlides - 1 ? "Finish" : "Next";
    }

    function changeSlide(dir) {
        currentSlide += dir;
        if(currentSlide < 0) currentSlide = 0;
        if(currentSlide >= totalSlides) currentSlide = totalSlides - 1;
        updateUI();
    }

    /* GENERIC VALIDATION LOGIC */
    function validateNum(input, expected, nextId) {
        if (parseInt(input.value) === expected) {
            input.classList.add('correct');
            input.classList.remove('wrong');
            
            // Special check for Slide 3 (Wait for all 3 inputs)
            if (nextId === 'check-sum-parts') {
                const inputs = document.querySelectorAll('#s3-step1 .math-input');
                const allCorrect = Array.from(inputs).every(i => i.classList.contains('correct'));
                if(allCorrect) {
                    document.getElementById('s3-final').classList.add('visible');
                    MathJax.typesetPromise();
                }
            } 
            // Standard logic
            else if(nextId) {
                document.getElementById(nextId).classList.add('visible');
                MathJax.typesetPromise();
            }
        } else {
            input.classList.add('wrong');
        }
    }

    /* LOGIC: Slide 4 Animation */
    let animStep = 0;
    function nextAnimStep() {
        animStep++;
        const el = document.getElementById(`anim-${animStep}`);
        if(el) {
            el.classList.add('visible');
            MathJax.typesetPromise();
        }
        if(animStep === 4) document.getElementById('anim-btn').style.display = "none";
    }

    // Init
    updateUI();

</script>
</body>
</html>
