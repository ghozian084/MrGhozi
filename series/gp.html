<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Geometric Progression</title>
    
    <!-- 1. CONFIGURE MATHJAX -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            svg: { fontCache: 'global' }
        };
    </script>

    <!-- 2. LOAD MATHJAX -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --primary: #8e44ad; /* Purple theme for GP */
            --secondary: #9b59b6;
            --success: #2ecc71;
            --error: #e74c3c;
            --bg: #f3e5f5;
            --card: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .main-card {
            background: var(--card);
            width: 100%;
            max-width: 850px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        /* Header & Progress */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
        }

        .progress-container {
            width: 100%;
            height: 8px;
            background: #eee;
            border-radius: 4px;
            margin-top: 10px;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--primary);
            width: 0%;
            border-radius: 4px;
            transition: width 0.4s ease;
        }

        /* Slide Logic */
        .slide { display: none; animation: fadeUp 0.5s ease forwards; }
        .slide.active { display: block; }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 { color: var(--primary); margin: 0; font-size: 1.8rem; }
        h2 { color: var(--primary); margin-top: 0; opacity: 0.8; }
        p { line-height: 1.6; color: #444; font-size: 1.05rem; }

        /* Interactive Input Elements */
        .math-input {
            width: 90px;
            padding: 8px;
            border: 2px solid #b2bec3;
            border-radius: 8px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: bold;
            color: #2d3436;
            transition: 0.3s;
            background: #f8f9fa;
        }
        
        .math-input:focus { outline: none; border-color: var(--primary); background: #fff; }
        .math-input.correct { border-color: var(--success); background-color: #d5f5e3; color: #2d3436; }
        .math-input.wrong { border-color: var(--error); background-color: #fadbd8; color: #2d3436; }

        .step-box {
            background: #fcfcfc;
            border-left: 5px solid var(--secondary);
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 10px 10px 0;
            display: none;
            opacity: 0;
            transform: translateX(-10px);
            transition: all 0.5s ease;
        }

        .step-box.visible { display: block; opacity: 1; transform: translateX(0); }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.1s, background 0.2s;
            margin: 5px;
        }
        .btn:hover { background: var(--secondary); }
        .btn:active { transform: scale(0.98); }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .sequence-display {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            text-align: center;
            letter-spacing: 2px;
            margin: 20px 0;
            background: #eee;
            padding: 10px;
            border-radius: 10px;
        }

    </style>
</head>
<body>

<div class="main-card">
    <div class="header">
        <h1>Geometric Progression (GP)</h1>
        <span id="slide-indicator">1 / 4</span>
    </div>
    <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
    </div>

    <!-- SLIDE 1: Identifying a and r -->
    <div class="slide active" id="slide1">
        <h2>1. Identifying the Common Ratio ($r$)</h2>
        <p>In a GP, we <strong>multiply</strong> by the same number ($r$) to get the next term.</p>
        
        <div class="sequence-display">3, 6, 12, 24, ...</div>

        <div class="step-box visible">
            <p><strong>Find the parameters:</strong></p>
            <p>First Term ($a$): <input type="number" class="math-input" onkeyup="validateFloat(this, 3, null)"></p>
            <p>Common Ratio ($r$): <input type="number" class="math-input" onkeyup="validateFloat(this, 2, 's1-part2')"></p>
            <small>Hint: $r = \frac{\text{2nd Term}}{\text{1st Term}}$</small>
        </div>

        <div class="step-box" id="s1-part2">
            <p><strong>Watch out! $r$ can be a fraction or negative.</strong></p>
            <div class="sequence-display" style="font-size: 1.2rem;">80, -40, 20, -10, ...</div>
            <p>$r = \frac{-40}{80} = $ <input type="text" class="math-input" placeholder="-0.?" onkeyup="validateFloat(this, -0.5, 's1-final')"></p>
        </div>
        
        <div class="step-box" id="s1-final">
            <p><span style="color:var(--success)">Correct!</span> Always check signs.</p>
        </div>
    </div>

    <!-- SLIDE 2: The nth Term Formula -->
    <div class="slide" id="slide2">
        <h2>2. Finding the $n$-th Term</h2>
        <p>Formula: $$ u_n = ar^{n-1} $$</p>
        <p>Find the <strong>6th term</strong> of: $2, 6, 18, \dots$</p>
        <p>Here $a=2$, $r=3$, $n=6$.</p>

        <div class="step-box visible">
            <strong>Step 1: The Power</strong>
            $$ u_{6} = 2 \times 3^{\text{power}} $$
            The power is $(n-1) = $ <input type="number" class="math-input" onkeyup="validateFloat(this, 5, 's2-step2')">
        </div>

        <div class="step-box" id="s2-step2">
            <strong>Step 2: Calculate</strong>
            $$ u_{6} = 2 \times 3^5 $$
            $$ u_{6} = 2 \times 243 $$
            $$ u_{6} = \dots $$
            <input type="number" class="math-input" onkeyup="validateFloat(this, 486, 's2-final')">
        </div>

        <div class="step-box" id="s2-final" style="background-color: #d5f5e3; border-color: #2ecc71;">
            <p>Correct. Geometric sequences grow very fast!</p>
        </div>
    </div>

    <!-- SLIDE 3: Sum to Infinity -->
    <div class="slide" id="slide3">
        <h2>3. Sum to Infinity ($S_\infty$)</h2>
        <p>If $|r| < 1$, the sequence gets smaller and smaller. We can add all terms up to infinity.</p>
        <p>Formula: $$ S_\infty = \frac{a}{1-r} $$</p>
        <p>Task: Find sum to infinity of $100, 20, 4, \dots$</p>

        <div class="step-box visible" id="s3-step1">
            <strong>Step 1: Check r</strong>
            $r = \frac{20}{100} = $ <input type="text" class="math-input" onkeyup="validateFloat(this, 0.2, 's3-step2')">
        </div>
        
        <div class="step-box" id="s3-step2">
            <strong>Step 2: Apply Formula</strong>
            Is $|0.2| < 1$? Yes. Proceed.
            $$ S_\infty = \frac{100}{1 - 0.2} = \frac{100}{0.8} $$
            Final Answer: <input type="number" class="math-input" onkeyup="validateFloat(this, 125, 's3-done')">
        </div>

        <div class="step-box" id="s3-done" style="color: var(--success); font-weight:bold;">
            Perfect! The sum converges to 125.
        </div>
    </div>

    <!-- SLIDE 4: Exam Style Animation -->
    <div class="slide" id="slide4">
        <h2>4. Exam Style: Working Backwards</h2>
        <p><strong>Problem:</strong> A geometric progression has a first term of <strong>40</strong> and a Sum to Infinity of <strong>100</strong>. Find the common ratio $r$ and the 2nd term.</p>
        
        <div style="text-align: center; margin: 20px;">
            <button class="btn" id="anim-btn" onclick="nextAnimStep()">Show Solution Steps</button>
        </div>

        <div id="anim-container">
            <!-- Step 1 -->
            <div class="step-box" id="anim-1">
                <strong>Step 1: Set up Equation</strong>
                $$ S_\infty = \frac{a}{1-r} = 100 $$
                $$ \frac{40}{1-r} = 100 $$
            </div>

            <!-- Step 2 -->
            <div class="step-box" id="anim-2">
                <strong>Step 2: Rearrange</strong>
                Multiply by $(1-r)$:
                $$ 40 = 100(1-r) $$
                Divide by 100:
                $$ 0.4 = 1 - r $$
            </div>

            <!-- Step 3 -->
            <div class="step-box" id="anim-3">
                <strong>Step 3: Solve for r</strong>
                $$ r = 1 - 0.4 $$
                $$ r = \mathbf{0.6} $$
            </div>

            <!-- Step 4 -->
            <div class="step-box" id="anim-4">
                <strong>Step 4: Find 2nd Term</strong>
                $$ u_2 = a \times r $$
                $$ u_2 = 40 \times 0.6 $$
                $$ u_2 = \mathbf{24} $$
            </div>
        </div>
    </div>

    <div class="navigation">
        <button class="btn" id="prevBtn" onclick="changeSlide(-1)" disabled>Previous</button>
        <button class="btn" id="nextBtn" onclick="changeSlide(1)">Next</button>
    </div>

</div>

<script>
    /* STATE MANAGEMENT */
    let currentSlide = 0;
    const totalSlides = 4;
    
    function updateUI() {
        // Update Slides
        document.querySelectorAll('.slide').forEach((s, i) => {
            s.classList.remove('active');
            if(i === currentSlide) s.classList.add('active');
        });

        // Update Progress
        document.getElementById('progress-bar').style.width = ((currentSlide + 1) / totalSlides * 100) + "%";
        document.getElementById('slide-indicator').innerText = `${currentSlide + 1} / ${totalSlides}`;

        // Update Buttons
        document.getElementById('prevBtn').disabled = currentSlide === 0;
        document.getElementById('nextBtn').innerText = currentSlide === totalSlides - 1 ? "Finish" : "Next";
    }

    function changeSlide(dir) {
        currentSlide += dir;
        if(currentSlide < 0) currentSlide = 0;
        if(currentSlide >= totalSlides) currentSlide = totalSlides - 1;
        updateUI();
    }

    /* FLOAT VALIDATION LOGIC (Crucial for GP) */
    function validateFloat(input, expected, nextId) {
        // Parse user input and expected value as floats
        const userVal = parseFloat(input.value);
        
        // Check if input is a number and close enough to expected (tolerance for floating point)
        if (!isNaN(userVal) && Math.abs(userVal - expected) < 0.01) {
            input.classList.add('correct');
            input.classList.remove('wrong');
            
            if(nextId) {
                document.getElementById(nextId).classList.add('visible');
                MathJax.typesetPromise();
            }
        } else {
            input.classList.add('wrong');
        }
    }

    /* LOGIC: Slide 4 Animation */
    let animStep = 0;
    function nextAnimStep() {
        animStep++;
        const el = document.getElementById(`anim-${animStep}`);
        if(el) {
            el.classList.add('visible');
            MathJax.typesetPromise();
        }
        if(animStep === 4) document.getElementById('anim-btn').style.display = "none";
    }

    // Init
    updateUI();

</script>
</body>
</html>
